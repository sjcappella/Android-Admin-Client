
package my.test;

import java.io.*;
import javax.swing.*;

//Splash screen for the admin after logging in
public class testUI2 extends javax.swing.JFrame {
    private BufferedReader in;
    private PrintWriter out;

    /** Creates new form testUI2 */
    public testUI2(BufferedReader inReader, PrintWriter outWrite) {
        in = inReader;
        out = outWrite;
        //Initialize components
        initComponents();
        //remove all the old tests
        testPicker.removeAllItems();
        //Send command to server to get all the test names
        out.println("GET_TEST_MENU");
        out.flush();
        int numTests;
        try{
            numTests = Integer.parseInt(in.readLine());
            for(int x = 0; x < numTests; x++){
                testPicker.addItem(in.readLine());
            }
        }catch(Exception e){
            //Handle the error
        } 
        
    }
   
    

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jComboBox1 = new javax.swing.JComboBox();
        jLabel3 = new javax.swing.JLabel();
        ADD = new javax.swing.JButton();
        EDIT = new javax.swing.JButton();
        DELETE = new javax.swing.JButton();
        EXIT = new javax.swing.JButton();
        STATISTICS = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        testPicker = new javax.swing.JComboBox();
        moreButton = new javax.swing.JButton();

        jComboBox1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        jComboBox1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox1ActionPerformed(evt);
            }
        });

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel3.setText("TEST MANAGEMENT CONSOLE");

        ADD.setText("ADD NEW TEST");
        ADD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ADDActionPerformed(evt);
            }
        });

        EDIT.setText("EDIT");
        EDIT.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                EDITActionPerformed(evt);
            }
        });

        DELETE.setText("DELETE");
        DELETE.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                DELETEActionPerformed(evt);
            }
        });

        EXIT.setText("LOGOUT");
        EXIT.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                EXITActionPerformed(evt);
            }
        });

        STATISTICS.setText("STATISTICS");
        STATISTICS.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                STATISTICSActionPerformed(evt);
            }
        });

        jLabel1.setText("Select a Test:");

        testPicker.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        moreButton.setText("MORE");
        moreButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                moreButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                .addGap(125, 125, 125)
                                .addComponent(jLabel3))
                            .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                .addGap(38, 38, 38)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(layout.createSequentialGroup()
                                        .addComponent(jLabel1)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 193, Short.MAX_VALUE))
                                    .addComponent(moreButton, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(EXIT, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap(37, Short.MAX_VALUE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(ADD, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(testPicker, 0, 207, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(STATISTICS, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 203, Short.MAX_VALUE)
                            .addComponent(EDIT, javax.swing.GroupLayout.DEFAULT_SIZE, 203, Short.MAX_VALUE)
                            .addComponent(DELETE, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 203, Short.MAX_VALUE))))
                .addGap(26, 26, 26))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(65, 65, 65)
                        .addComponent(jLabel1))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(39, 39, 39)
                        .addComponent(jLabel3)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(testPicker, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(EDIT))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(STATISTICS)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(DELETE)
                    .addComponent(ADD))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 101, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(moreButton)
                    .addComponent(EXIT))
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

//Go to statistics screen
private void STATISTICSActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_STATISTICSActionPerformed
    //Get the test name selected
    TestStatistics statScreen = new TestStatistics(in, out, testPicker.getSelectedItem().toString());
    statScreen.setLocation(this.getX(), this.getY());
    statScreen.setVisible(true);
    this.setVisible(false);
    
}//GEN-LAST:event_STATISTICSActionPerformed

//Add a test
private void ADDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ADDActionPerformed

    testUI4 test4 = new testUI4(in, out);
    test4.setLocation(this.getX(), this.getY());
    test4.setVisible(true);
    this.setVisible(false);
}//GEN-LAST:event_ADDActionPerformed

//Edit a test
private void EDITActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_EDITActionPerformed
    //Get the test name selected
    String testName = testPicker.getSelectedItem().toString();
    testUI5 testUI5 = new testUI5(in, out, testName);
    testUI5.setLocation(this.getX(), this.getY());
    testUI5.setVisible(true);
    this.setVisible(false);
}//GEN-LAST:event_EDITActionPerformed

//Exit the admin program
private void EXITActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_EXITActionPerformed

    this.setVisible(false);
        System.exit(0);
}//GEN-LAST:event_EXITActionPerformed

private void jComboBox1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox1ActionPerformed
    // TODO add your handling code here:
}//GEN-LAST:event_jComboBox1ActionPerformed

//Delete a selected test
private void DELETEActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DELETEActionPerformed
    //Confirm the admin wants to selete test
    int answer = JOptionPane.showConfirmDialog(this, "Would you like to delete this test from the server?", "Submit Test?", JOptionPane.YES_NO_OPTION);
    //Yes = 0, No = 1
    if(answer == 0){
        //Call delete test function. Returns true if successfull
        if(deleteTest()){
            //Success
            JOptionPane.showMessageDialog(this, "Your test was successfully deleted from the server!", "Success!", JOptionPane.INFORMATION_MESSAGE);
            testPicker.removeAllItems();
            testUI2 newScreen = new testUI2(in, out);
            newScreen.setLocation(this.getX(), this.getY());
            this.setVisible(false);
            newScreen.setVisible(true);
        }else{
            //Failure
            JOptionPane.showMessageDialog(this, "There was an error deleting your test from the server!", "Error!", JOptionPane.ERROR_MESSAGE);
            testUI2 newScreen = new testUI2(in, out);
            newScreen.setLocation(this.getX(), this.getY());
            this.setVisible(false);
            newScreen.setVisible(true);
        }
    }
}//GEN-LAST:event_DELETEActionPerformed

//Go to the more options screen
private void moreButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_moreButtonActionPerformed

    MoreOptions moreOptions = new MoreOptions(in, out);
    moreOptions.setLocation(this.getX(), this.getY());
    this.setVisible(false);
    moreOptions.setVisible(true);
}//GEN-LAST:event_moreButtonActionPerformed

//Function to delete test
private boolean deleteTest(){
    //Get the name of the test selected by the user
    String testName = testPicker.getSelectedItem().toString();
    //Send command to the server
    out.println("DELETE_TEST");
    out.flush();
    //Send test name to the server
    out.println(testName);
    out.flush();
    //Look for success/failure
    try{
        if(in.readLine().equals("DELETE_TEST_SUCCESSFUL")){
            return true;
        }else{
            return false;
        }
    }catch(Exception e){
        //Handle the error
        return false;
    }

}
    /**
     * @param args the command line arguments
     */
    public void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(testUI2.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(testUI2.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(testUI2.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(testUI2.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new testUI2(in, out).setVisible(true);
                
            }
        });  
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton ADD;
    private javax.swing.JButton DELETE;
    private javax.swing.JButton EDIT;
    private javax.swing.JButton EXIT;
    private javax.swing.JButton STATISTICS;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JButton moreButton;
    private javax.swing.JComboBox testPicker;
    // End of variables declaration//GEN-END:variables
}
